(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.apiFetch;var a=e.n(n);const l=window.wp.components,s=e=>{let{postId:n}=e;const[s,o]=(0,t.useState)(!1);return s?(0,t.createElement)("p",null,"Post deleted."):(0,t.createElement)(l.Button,{isDestructive:!0,onClick:()=>{a()({path:`/wp/v2/stas_product/${n}`,method:"DELETE"}).then((e=>{console.log("Deleted post:",e),o(!0)})).catch((e=>{console.error("Error deleting post:",e)}))}},"Delete")};class o extends t.Component{state={posts:[]};getFeaturedImageUrl(e){const t=e._embedded["wp:featuredmedia"];return t&&t.length>0?t[0].source_url:null}async componentDidMount(){const e=await a()({path:"/wp/v2/stas_product?per_page=100&_embed"});this.setState({posts:e}),console.log(e)}render(){const{posts:e}=this.state,{onAddNew:n,onEdit:a}=this.props;return(0,t.createElement)("div",null,(0,t.createElement)("h1",null,"Products"),(0,t.createElement)(l.__experimentalText,null,(0,t.createElement)(l.Button,{variant:"secondary",onClick:n},"Add New Product")),e.map((e=>{const n=this.getFeaturedImageUrl(e);return(0,t.createElement)(l.__experimentalGrid,{columns:4,key:e.id},(0,t.createElement)(l.__experimentalText,null,e.title.rendered),(0,t.createElement)(l.__experimentalText,null,n&&(0,t.createElement)("img",{src:n,alt:e.title.rendered,style:{width:"100px",marginRight:"10px"}})),(0,t.createElement)(l.__experimentalText,null,(0,t.createElement)(l.Button,{variant:"primary",onClick:()=>a(e.id)},"Edit")),(0,t.createElement)(l.__experimentalText,null,(0,t.createElement)(s,{postId:e.id})))})))}}const r=o,c=window.wp.i18n,i=window.wp.data,u=window.wp.notices,d=()=>{const e=(0,i.useSelect)((e=>e(u.store).getNotices().filter((e=>"snackbar"===e.type))),[]),{removeNotice:n}=(0,i.useDispatch)(u.store);return(0,t.createElement)(l.SnackbarList,{className:"edit-site-notices",notices:e,onRemove:n})},m=e=>{let{onPostCreated:n,onCancel:s}=e;const[o,r]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[p,_]=(0,t.useState)(0),[h,E]=(0,t.useState)(0),[v,w]=(0,t.useState)(!1),[g,b]=(0,t.useState)(""),[C,S]=(0,t.useState)(null),[y,x]=(0,t.useState)(""),[k,P]=(0,t.useState)(!1),[I,T]=(0,t.useState)(!1),[f,N]=(0,t.useState)(null);return(0,t.useEffect)((()=>{I&&f&&n(f)}),[I,f]),(0,t.createElement)("div",null,(0,t.createElement)(l.__experimentalText,null,(0,t.createElement)(l.Button,{variant:"secondary",onClick:s},"Back to List")),(0,t.createElement)("h2",null,"Add New Custom Post"),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Title:","wholesome-plugin"),onChange:e=>r(e),value:o}),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Excerpt:","wholesome-plugin"),onChange:e=>m(e),value:u}),(0,t.createElement)("label",null,"Price:",(0,t.createElement)("input",{type:"number",value:p,onChange:e=>_(parseInt(e.target.value))})),(0,t.createElement)("label",null,"Sale Price:",(0,t.createElement)("input",{type:"number",value:h,onChange:e=>E(parseInt(e.target.value))})),(0,t.createElement)(l.CheckboxControl,{label:"Is on sale",checked:v,onChange:w}),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Youtube link:","wholesome-plugin"),onChange:e=>b(e),value:g}),(0,t.createElement)(l.Button,{isPrimary:!0,isLarge:!0,onClick:()=>{(async()=>{P(!0);const e={title:o,excerpt:u,stas_price_value:parseInt(p),stas_sale_price_value:parseInt(h),stas_is_onsale_value:v,stas_youtube_link_value:g,featured_media:C,status:"publish"};try{const t=await a()({path:"/wp/v2/stas_product",method:"POST",data:e});N(t.id),T(!0)}catch(e){console.error("Error creating post:",e)}finally{P(!1)}})(),(0,i.dispatch)("core/notices").createNotice("success",(0,c.__)("Post Saved","wholesome-plugin"),{type:"snackbar",isDismissible:!0})}},k?"Saving...":"Save"),(0,t.createElement)("div",{className:"wholesome-plugin__notices"},(0,t.createElement)(d,null)))},p=()=>{const e=(0,i.useSelect)((e=>e(u.store).getNotices().filter((e=>"snackbar"===e.type))),[]),{removeNotice:n}=(0,i.useDispatch)(u.store);return(0,t.createElement)(l.SnackbarList,{className:"edit-site-notices",notices:e,onRemove:n})},_=e=>{let{postId:n,onBack:s}=e;const[o,r]=(0,t.useState)(null),[u,d]=(0,t.useState)(""),[m,_]=(0,t.useState)(""),[h,E]=(0,t.useState)(0),[v,w]=(0,t.useState)(0),[g,b]=(0,t.useState)(!1),[C,S]=(0,t.useState)(""),[y,x]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{(async()=>{try{const e=await a()({path:`/wp/v2/stas_product/${n}?_embed`});r(e),d(e.title.rendered),_(e.excerpt.rendered),E(parseInt(e.stas_price_value)||0),w(parseInt(e.stas_sale_price_value)||0),b(e.stas_is_onsale_value),S(e.stas_youtube_link_value)}catch(e){console.error("Error fetching post:",e)}})()}),[n]),o?(0,t.createElement)("div",null,(0,t.createElement)(l.__experimentalText,null,(0,t.createElement)(l.Button,{variant:"secondary",onClick:s},"Back to List")),(0,t.createElement)("h2",null,"Edit Custom Post"),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Title:","wholesome-plugin"),onChange:e=>d(e),value:u}),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Excerpt:","wholesome-plugin"),onChange:e=>_(e),value:m}),(0,t.createElement)("label",null,"Price:",(0,t.createElement)("input",{type:"number",value:h,onChange:e=>E(parseInt(e.target.value))})),(0,t.createElement)("label",null,"Sale Price:",(0,t.createElement)("input",{type:"number",value:v,onChange:e=>w(parseInt(e.target.value))})),(0,t.createElement)(l.CheckboxControl,{label:"Is on sale",checked:g,onChange:b}),(0,t.createElement)(l.TextControl,{label:(0,c.__)("Youtube link:","wholesome-plugin"),onChange:e=>S(e),value:C}),(0,t.createElement)(l.Button,{isPrimary:!0,isLarge:!0,onClick:()=>{(async()=>{x(!0);const e={title:u,excerpt:m,stas_price_value:parseInt(h),stas_sale_price_value:parseInt(v),stas_is_onsale_value:g,stas_youtube_link_value:C};try{await a()({path:`/wp/v2/stas_product/${n}`,method:"POST",data:e}),console.log(e),console.log("Post updated successfully!")}catch(t){console.log(e),console.error("Error updating post:",t)}finally{x(!1)}})(),(0,i.dispatch)("core/notices").createNotice("success",(0,c.__)("Post Saved","wholesome-plugin"),{type:"snackbar",isDismissible:!0})}},y?"Saving...":"Save"),(0,t.createElement)("div",{className:"wholesome-plugin__notices"},(0,t.createElement)(p,null))):(0,t.createElement)("div",null,"Loading...")};class h extends t.Component{state={view:"list",selectedPostId:null};showList=()=>{this.setState({view:"list",selectedPostId:null})};showEditor=e=>{this.setState({view:"editor",selectedPostId:e})};render(){const{view:e,selectedPostId:n}=this.state;return"list"===e?(0,t.createElement)(r,{onAddNew:()=>this.showEditor(null),onEdit:this.showEditor,className:"stas-plugin__main"}):"editor"===e?n?(0,t.createElement)(_,{postId:n,onBack:this.showList}):(0,t.createElement)(m,{onPostCreated:this.showEditor,onCancel:this.showList}):void 0}}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("root_id");e&&(0,t.render)((0,t.createElement)(h,null),e)}))})();